2025-12-23 00:17:32,063 - train_domain - INFO - Training started
2025-12-23 00:17:32,063 - train_domain - INFO - ============================================================
2025-12-23 00:17:32,063 - train_domain - INFO - STARTING DOMAIN MODEL TRAINING
2025-12-23 00:17:32,065 - train_domain - INFO - ============================================================
2025-12-23 00:17:32,069 - train_domain - INFO - Domain dataset loaded successfully. Shape: (524, 4)
2025-12-23 00:17:32,070 - train_domain - INFO - Class distribution:
1    287
0    237
Name: is_malicious, dtype: int64
2025-12-23 00:17:32,070 - train_domain - INFO - Starting feature engineering...
2025-12-23 00:17:32,154 - train_domain - INFO - Feature engineering completed. Total features: 18
2025-12-23 00:17:32,155 - train_domain - INFO - Feature columns: ['is_malicious', 'risk_score', 'domain_length', 'num_dots', 'num_hyphens', 'num_underscores', 'has_digits', 'digit_count', 'letter_count', 'tld_length', 'subdomain_count', 'special_char_count', 'entropy', 'risk_score_normalized', 'domain_length_risk_interaction', 'is_ip_like', 'has_common_tld', 'has_suspicious_tld']
2025-12-23 00:17:32,157 - train_domain - INFO - X shape: (524, 17), y shape: (524,)
2025-12-23 00:17:32,158 - train_domain - INFO - Scaling features...
2025-12-23 00:17:32,241 - train_domain - INFO - Train set: 419 samples
2025-12-23 00:17:32,241 - train_domain - INFO - Test set: 105 samples
2025-12-23 00:17:32,242 - train_domain - INFO - Positive samples in train: 229 (54.7%)
2025-12-23 00:17:32,242 - train_domain - INFO - Positive samples in test: 58 (55.2%)
2025-12-23 00:17:32,242 - train_domain - INFO - 
============================================================
2025-12-23 00:17:32,242 - train_domain - INFO - STARTING MODEL TRAINING WITH 50 EPOCHS/ITERATIONS
2025-12-23 00:17:32,242 - train_domain - INFO - ============================================================
2025-12-23 00:17:32,242 - train_domain - INFO - 
Training logistic_regression...
2025-12-23 00:17:32,242 - train_domain - INFO - Parameters to search: {'C': [0.001, 0.01, 0.1, 1, 10, 100], 'penalty': ['l1', 'l2'], 'solver': ['liblinear', 'saga'], 'max_iter': [50]}
2025-12-23 00:17:35,596 - train_domain - INFO - logistic_regression Results:
2025-12-23 00:17:35,596 - train_domain - INFO -   Best Parameters: {'C': 0.001, 'max_iter': 50, 'penalty': 'l2', 'solver': 'saga'}
2025-12-23 00:17:35,597 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:17:35,597 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:17:35,597 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:17:35,598 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:17:35,598 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:17:35,598 - train_domain - INFO -   *** New Best Model! ***
2025-12-23 00:17:35,598 - train_domain - INFO - 
Training random_forest...
2025-12-23 00:17:35,599 - train_domain - INFO - Parameters to search: {'n_estimators': [50], 'max_depth': [5, 10, 20, None], 'min_samples_split': [2, 5, 10], 'min_samples_leaf': [1, 2, 4], 'max_features': ['sqrt', 'log2', None]}
2025-12-23 00:17:40,861 - train_domain - INFO - random_forest Results:
2025-12-23 00:17:40,861 - train_domain - INFO -   Best Parameters: {'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 50}
2025-12-23 00:17:40,861 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:17:40,861 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:17:40,861 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:17:40,861 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:17:40,861 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:17:40,861 - train_domain - INFO - 
Training gradient_boosting...
2025-12-23 00:17:40,861 - train_domain - INFO - Parameters to search: {'n_estimators': [50], 'learning_rate': [0.001, 0.01, 0.1, 0.2], 'max_depth': [3, 5, 7, 9], 'min_samples_split': [2, 5, 10], 'min_samples_leaf': [1, 2, 4], 'subsample': [0.8, 0.9, 1.0]}
2025-12-23 00:17:53,157 - train_domain - INFO - gradient_boosting Results:
2025-12-23 00:17:53,157 - train_domain - INFO -   Best Parameters: {'learning_rate': 0.01, 'max_depth': 3, 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 50, 'subsample': 0.8}
2025-12-23 00:17:53,157 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:17:53,157 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:17:53,159 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:17:53,159 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:17:53,159 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:17:53,159 - train_domain - INFO - 
Training svc...
2025-12-23 00:17:53,159 - train_domain - INFO - Parameters to search: {'C': [0.1, 1, 10, 100], 'kernel': ['linear', 'rbf', 'poly'], 'gamma': ['scale', 'auto', 0.1, 1], 'max_iter': [50]}
2025-12-23 00:17:53,458 - train_domain - INFO - svc Results:
2025-12-23 00:17:53,459 - train_domain - INFO -   Best Parameters: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear', 'max_iter': 50}
2025-12-23 00:17:53,459 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:17:53,459 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:17:53,459 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:17:53,459 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:17:53,459 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:17:53,459 - train_domain - INFO - 
============================================================
2025-12-23 00:17:53,459 - train_domain - INFO - TRAINING SUMMARY
2025-12-23 00:17:53,461 - train_domain - INFO - ============================================================
2025-12-23 00:17:53,461 - train_domain - INFO - LOGISTIC_REGRESSION  Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:17:53,461 - train_domain - INFO - RANDOM_FOREST        Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:17:53,461 - train_domain - INFO - GRADIENT_BOOSTING    Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:17:53,461 - train_domain - INFO - SVC                  Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:17:53,461 - train_domain - INFO - 
Best model: logistic_regression
2025-12-23 00:17:53,461 - train_domain - INFO - Best accuracy: 1.000000
2025-12-23 00:17:53,462 - train_domain - INFO - Best parameters: {'C': 0.001, 'max_iter': 50, 'penalty': 'l2', 'solver': 'saga'}
2025-12-23 00:17:53,462 - train_domain - INFO - 
============================================================
2025-12-23 00:17:53,462 - train_domain - INFO - FINAL EVALUATION OF BEST MODEL
2025-12-23 00:17:53,462 - train_domain - INFO - ============================================================
2025-12-23 00:17:53,482 - train_domain - INFO - Accuracy: 1.0000
2025-12-23 00:17:53,482 - train_domain - INFO - Precision: 1.0000
2025-12-23 00:17:53,482 - train_domain - INFO - Recall: 1.0000
2025-12-23 00:17:53,483 - train_domain - INFO - F1-Score: 1.0000
2025-12-23 00:17:53,483 - train_domain - INFO - Confusion Matrix:
[[47  0]
 [ 0 58]]
2025-12-23 00:17:53,483 - train_domain - INFO - 
Confusion Matrix:
2025-12-23 00:17:53,485 - train_domain - INFO -   True Negatives:  47
2025-12-23 00:17:53,485 - train_domain - INFO -   False Positives: 0
2025-12-23 00:17:53,485 - train_domain - INFO -   False Negatives: 0
2025-12-23 00:17:53,485 - train_domain - INFO -   True Positives:  58
2025-12-23 00:17:54,667 - train_domain - INFO - 
Model saved to: models/domain_model.pkl
2025-12-23 00:17:54,668 - train_domain - INFO - Scaler saved to: models/scaler_domain.pkl
2025-12-23 00:17:54,733 - train_domain - INFO - Feature names saved to: models/domain_feature_names.pkl
2025-12-23 00:17:54,740 - train_domain - INFO - 
============================================================
2025-12-23 00:17:54,740 - train_domain - INFO - TRAINING COMPLETED SUCCESSFULLY
2025-12-23 00:17:54,740 - train_domain - INFO - Total training time: 22.68 seconds
2025-12-23 00:17:54,740 - train_domain - INFO - ============================================================
2025-12-23 00:20:40,438 - train_domain - INFO - Training started
2025-12-23 00:20:40,438 - train_domain - INFO - ============================================================
2025-12-23 00:20:40,438 - train_domain - INFO - STARTING DOMAIN MODEL TRAINING
2025-12-23 00:20:40,439 - train_domain - INFO - ============================================================
2025-12-23 00:20:40,442 - train_domain - INFO - Domain dataset loaded successfully. Shape: (524, 4)
2025-12-23 00:20:40,442 - train_domain - INFO - Class distribution:
1    287
0    237
Name: is_malicious, dtype: int64
2025-12-23 00:20:40,442 - train_domain - INFO - Starting feature engineering...
2025-12-23 00:20:40,463 - train_domain - INFO - Feature engineering completed. Total features: 18
2025-12-23 00:20:40,463 - train_domain - INFO - Feature columns: ['is_malicious', 'risk_score', 'domain_length', 'num_dots', 'num_hyphens', 'num_underscores', 'has_digits', 'digit_count', 'letter_count', 'tld_length', 'subdomain_count', 'special_char_count', 'entropy', 'risk_score_normalized', 'domain_length_risk_interaction', 'is_ip_like', 'has_common_tld', 'has_suspicious_tld']
2025-12-23 00:20:40,464 - train_domain - INFO - X shape: (524, 17), y shape: (524,)
2025-12-23 00:20:40,466 - train_domain - INFO - Scaling features...
2025-12-23 00:20:40,469 - train_domain - INFO - Train set: 419 samples
2025-12-23 00:20:40,469 - train_domain - INFO - Test set: 105 samples
2025-12-23 00:20:40,470 - train_domain - INFO - Positive samples in train: 229 (54.7%)
2025-12-23 00:20:40,470 - train_domain - INFO - Positive samples in test: 58 (55.2%)
2025-12-23 00:20:40,470 - train_domain - INFO - 
============================================================
2025-12-23 00:20:40,471 - train_domain - INFO - STARTING MODEL TRAINING WITH 50 EPOCHS/ITERATIONS
2025-12-23 00:20:40,471 - train_domain - INFO - ============================================================
2025-12-23 00:20:40,471 - train_domain - INFO - 
Training logistic_regression...
2025-12-23 00:20:40,471 - train_domain - INFO - Parameters to search: {'C': [0.001, 0.01, 0.1, 1, 10, 100], 'penalty': ['l1', 'l2'], 'solver': ['liblinear', 'saga'], 'max_iter': [1000]}
2025-12-23 00:20:43,610 - train_domain - INFO - logistic_regression Results:
2025-12-23 00:20:43,610 - train_domain - INFO -   Best Parameters: {'C': 0.001, 'max_iter': 1000, 'penalty': 'l2', 'solver': 'saga'}
2025-12-23 00:20:43,610 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:20:43,611 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:20:43,611 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:20:43,611 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:20:43,611 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:20:43,611 - train_domain - INFO -   *** New Best Model! ***
2025-12-23 00:20:43,611 - train_domain - INFO - 
Training random_forest...
2025-12-23 00:20:43,611 - train_domain - INFO - Parameters to search: {'n_estimators': [50], 'max_depth': [5, 10, 20, None], 'min_samples_split': [2, 5, 10], 'min_samples_leaf': [1, 2, 4], 'max_features': ['sqrt', 'log2', None]}
2025-12-23 00:20:48,581 - train_domain - INFO - random_forest Results:
2025-12-23 00:20:48,581 - train_domain - INFO -   Best Parameters: {'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 50}
2025-12-23 00:20:48,582 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:20:48,582 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:20:48,582 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:20:48,582 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:20:48,582 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:20:48,583 - train_domain - INFO - 
Training gradient_boosting...
2025-12-23 00:20:48,583 - train_domain - INFO - Parameters to search: {'n_estimators': [50], 'learning_rate': [0.001, 0.01, 0.1, 0.2], 'max_depth': [3, 5, 7, 9], 'min_samples_split': [2, 5, 10], 'min_samples_leaf': [1, 2, 4], 'subsample': [0.8, 0.9, 1.0]}
2025-12-23 00:21:01,134 - train_domain - INFO - gradient_boosting Results:
2025-12-23 00:21:01,134 - train_domain - INFO -   Best Parameters: {'learning_rate': 0.01, 'max_depth': 3, 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 50, 'subsample': 0.8}
2025-12-23 00:21:01,134 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:21:01,134 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:21:01,135 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:21:01,135 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:21:01,135 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:21:01,135 - train_domain - INFO - 
Training svc...
2025-12-23 00:21:01,135 - train_domain - INFO - Parameters to search: {'C': [0.1, 1, 10, 100], 'kernel': ['linear', 'rbf', 'poly'], 'gamma': ['scale', 'auto', 0.1, 1], 'max_iter': [1000]}
2025-12-23 00:21:01,408 - train_domain - INFO - svc Results:
2025-12-23 00:21:01,409 - train_domain - INFO -   Best Parameters: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear', 'max_iter': 1000}
2025-12-23 00:21:01,409 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:21:01,409 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:21:01,409 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:21:01,409 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:21:01,410 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:21:01,410 - train_domain - INFO - 
============================================================
2025-12-23 00:21:01,410 - train_domain - INFO - TRAINING SUMMARY
2025-12-23 00:21:01,410 - train_domain - INFO - ============================================================
2025-12-23 00:21:01,410 - train_domain - INFO - LOGISTIC_REGRESSION  Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:21:01,410 - train_domain - INFO - RANDOM_FOREST        Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:21:01,410 - train_domain - INFO - GRADIENT_BOOSTING    Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:21:01,410 - train_domain - INFO - SVC                  Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:21:01,410 - train_domain - INFO - 
Best model: logistic_regression
2025-12-23 00:21:01,411 - train_domain - INFO - Best accuracy: 1.000000
2025-12-23 00:21:01,411 - train_domain - INFO - Best parameters: {'C': 0.001, 'max_iter': 1000, 'penalty': 'l2', 'solver': 'saga'}
2025-12-23 00:21:01,411 - train_domain - INFO - 
============================================================
2025-12-23 00:21:01,411 - train_domain - INFO - FINAL EVALUATION OF BEST MODEL
2025-12-23 00:21:01,411 - train_domain - INFO - ============================================================
2025-12-23 00:21:01,416 - train_domain - INFO - Accuracy: 1.0000
2025-12-23 00:21:01,416 - train_domain - INFO - Precision: 1.0000
2025-12-23 00:21:01,417 - train_domain - INFO - Recall: 1.0000
2025-12-23 00:21:01,417 - train_domain - INFO - F1-Score: 1.0000
2025-12-23 00:21:01,417 - train_domain - INFO - Confusion Matrix:
[[47  0]
 [ 0 58]]
2025-12-23 00:21:01,418 - train_domain - INFO - 
Confusion Matrix:
2025-12-23 00:21:01,418 - train_domain - INFO -   True Negatives:  47
2025-12-23 00:21:01,418 - train_domain - INFO -   False Positives: 0
2025-12-23 00:21:01,418 - train_domain - INFO -   False Negatives: 0
2025-12-23 00:21:01,418 - train_domain - INFO -   True Positives:  58
2025-12-23 00:21:01,873 - train_domain - INFO - 
Model saved to: models/domain_model.pkl
2025-12-23 00:21:01,873 - train_domain - INFO - Scaler saved to: models/scaler_domain.pkl
2025-12-23 00:21:01,918 - train_domain - INFO - Feature names saved to: models/domain_feature_names.pkl
2025-12-23 00:21:01,923 - train_domain - INFO - 
============================================================
2025-12-23 00:21:01,923 - train_domain - INFO - TRAINING COMPLETED SUCCESSFULLY
2025-12-23 00:21:01,923 - train_domain - INFO - Total training time: 21.48 seconds
2025-12-23 00:21:01,923 - train_domain - INFO - ============================================================
2025-12-23 00:21:46,497 - train_domain - INFO - Training started
2025-12-23 00:21:46,498 - train_domain - INFO - ============================================================
2025-12-23 00:21:46,498 - train_domain - INFO - STARTING DOMAIN MODEL TRAINING
2025-12-23 00:21:46,498 - train_domain - INFO - ============================================================
2025-12-23 00:21:46,501 - train_domain - INFO - Domain dataset loaded successfully. Shape: (524, 4)
2025-12-23 00:21:46,502 - train_domain - INFO - Class distribution:
1    287
0    237
Name: is_malicious, dtype: int64
2025-12-23 00:21:46,502 - train_domain - INFO - Starting feature engineering...
2025-12-23 00:21:46,522 - train_domain - INFO - Feature engineering completed. Total features: 18
2025-12-23 00:21:46,523 - train_domain - INFO - Feature columns: ['is_malicious', 'risk_score', 'domain_length', 'num_dots', 'num_hyphens', 'num_underscores', 'has_digits', 'digit_count', 'letter_count', 'tld_length', 'subdomain_count', 'special_char_count', 'entropy', 'risk_score_normalized', 'domain_length_risk_interaction', 'is_ip_like', 'has_common_tld', 'has_suspicious_tld']
2025-12-23 00:21:46,524 - train_domain - INFO - X shape: (524, 17), y shape: (524,)
2025-12-23 00:21:46,524 - train_domain - INFO - Scaling features...
2025-12-23 00:21:46,528 - train_domain - INFO - Train set: 419 samples
2025-12-23 00:21:46,528 - train_domain - INFO - Test set: 105 samples
2025-12-23 00:21:46,529 - train_domain - INFO - Positive samples in train: 229 (54.7%)
2025-12-23 00:21:46,529 - train_domain - INFO - Positive samples in test: 58 (55.2%)
2025-12-23 00:21:46,529 - train_domain - INFO - 
============================================================
2025-12-23 00:21:46,530 - train_domain - INFO - STARTING MODEL TRAINING WITH 50 EPOCHS/ITERATIONS
2025-12-23 00:21:46,530 - train_domain - INFO - ============================================================
2025-12-23 00:21:46,530 - train_domain - INFO - 
Training logistic_regression...
2025-12-23 00:21:46,530 - train_domain - INFO - Parameters to search: {'C': [0.001, 0.01, 0.1, 1, 10, 100], 'penalty': ['l2'], 'solver': ['lbfgs'], 'max_iter': [1000]}
2025-12-23 00:21:49,333 - train_domain - INFO - logistic_regression Results:
2025-12-23 00:21:49,334 - train_domain - INFO -   Best Parameters: {'C': 0.001, 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-12-23 00:21:49,334 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:21:49,334 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:21:49,334 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:21:49,334 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:21:49,334 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:21:49,335 - train_domain - INFO -   *** New Best Model! ***
2025-12-23 00:21:49,335 - train_domain - INFO - 
Training random_forest...
2025-12-23 00:21:49,335 - train_domain - INFO - Parameters to search: {'n_estimators': [50], 'max_depth': [5, 10, 20, None], 'min_samples_split': [2, 5, 10], 'min_samples_leaf': [1, 2, 4], 'max_features': ['sqrt', 'log2', None]}
2025-12-23 00:21:54,408 - train_domain - INFO - random_forest Results:
2025-12-23 00:21:54,408 - train_domain - INFO -   Best Parameters: {'max_depth': 5, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 50}
2025-12-23 00:21:54,408 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:21:54,408 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:21:54,408 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:21:54,408 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:21:54,409 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:21:54,409 - train_domain - INFO - 
Training gradient_boosting...
2025-12-23 00:21:54,409 - train_domain - INFO - Parameters to search: {'n_estimators': [50], 'learning_rate': [0.001, 0.01, 0.1, 0.2], 'max_depth': [3, 5, 7, 9], 'min_samples_split': [2, 5, 10], 'min_samples_leaf': [1, 2, 4], 'subsample': [0.8, 0.9, 1.0]}
2025-12-23 00:22:07,137 - train_domain - INFO - gradient_boosting Results:
2025-12-23 00:22:07,137 - train_domain - INFO -   Best Parameters: {'learning_rate': 0.01, 'max_depth': 3, 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 50, 'subsample': 0.8}
2025-12-23 00:22:07,137 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:22:07,137 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:22:07,137 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:22:07,137 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:22:07,137 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:22:07,138 - train_domain - INFO - 
Training svc...
2025-12-23 00:22:07,138 - train_domain - INFO - Parameters to search: {'C': [0.1, 1, 10, 100], 'kernel': ['linear', 'rbf', 'poly'], 'gamma': ['scale', 'auto', 0.1, 1], 'max_iter': [1000]}
2025-12-23 00:22:07,431 - train_domain - INFO - svc Results:
2025-12-23 00:22:07,432 - train_domain - INFO -   Best Parameters: {'C': 0.1, 'gamma': 'scale', 'kernel': 'linear', 'max_iter': 1000}
2025-12-23 00:22:07,432 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:22:07,432 - train_domain - INFO -   Testing Accuracy: 1.000000
2025-12-23 00:22:07,432 - train_domain - INFO -   Precision: 1.000000
2025-12-23 00:22:07,432 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:22:07,432 - train_domain - INFO -   F1-Score: 1.000000
2025-12-23 00:22:07,432 - train_domain - INFO - 
============================================================
2025-12-23 00:22:07,432 - train_domain - INFO - TRAINING SUMMARY
2025-12-23 00:22:07,432 - train_domain - INFO - ============================================================
2025-12-23 00:22:07,432 - train_domain - INFO - LOGISTIC_REGRESSION  Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:22:07,432 - train_domain - INFO - RANDOM_FOREST        Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:22:07,432 - train_domain - INFO - GRADIENT_BOOSTING    Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:22:07,432 - train_domain - INFO - SVC                  Test Acc: 1.000000 | Precision: 1.000000 | Recall: 1.000000 | F1: 1.000000
2025-12-23 00:22:07,432 - train_domain - INFO - 
Best model: logistic_regression
2025-12-23 00:22:07,433 - train_domain - INFO - Best accuracy: 1.000000
2025-12-23 00:22:07,433 - train_domain - INFO - Best parameters: {'C': 0.001, 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-12-23 00:22:07,433 - train_domain - INFO - 
============================================================
2025-12-23 00:22:07,433 - train_domain - INFO - FINAL EVALUATION OF BEST MODEL
2025-12-23 00:22:07,433 - train_domain - INFO - ============================================================
2025-12-23 00:22:07,439 - train_domain - INFO - Accuracy: 1.0000
2025-12-23 00:22:07,439 - train_domain - INFO - Precision: 1.0000
2025-12-23 00:22:07,439 - train_domain - INFO - Recall: 1.0000
2025-12-23 00:22:07,439 - train_domain - INFO - F1-Score: 1.0000
2025-12-23 00:22:07,439 - train_domain - INFO - Confusion Matrix:
[[47  0]
 [ 0 58]]
2025-12-23 00:22:07,440 - train_domain - INFO - 
Confusion Matrix:
2025-12-23 00:22:07,440 - train_domain - INFO -   True Negatives:  47
2025-12-23 00:22:07,440 - train_domain - INFO -   False Positives: 0
2025-12-23 00:22:07,440 - train_domain - INFO -   False Negatives: 0
2025-12-23 00:22:07,440 - train_domain - INFO -   True Positives:  58
2025-12-23 00:22:07,875 - train_domain - INFO - 
Model saved to: models/domain_model.pkl
2025-12-23 00:22:07,875 - train_domain - INFO - Scaler saved to: models/scaler_domain.pkl
2025-12-23 00:22:07,936 - train_domain - INFO - Feature names saved to: models/domain_feature_names.pkl
2025-12-23 00:22:07,943 - train_domain - INFO - 
============================================================
2025-12-23 00:22:07,944 - train_domain - INFO - TRAINING COMPLETED SUCCESSFULLY
2025-12-23 00:22:07,944 - train_domain - INFO - Total training time: 21.45 seconds
2025-12-23 00:22:07,944 - train_domain - INFO - ============================================================
2025-12-23 00:33:50,030 - train_domain - INFO - Training started
2025-12-23 00:33:50,031 - train_domain - INFO - ============================================================
2025-12-23 00:33:50,031 - train_domain - INFO - STARTING DOMAIN MODEL TRAINING
2025-12-23 00:33:50,031 - train_domain - INFO - ============================================================
2025-12-23 00:33:50,067 - train_domain - INFO - Removed 106 duplicate domains.
2025-12-23 00:33:50,068 - train_domain - INFO - Domain dataset loaded successfully. Shape: (595, 4)
2025-12-23 00:33:50,069 - train_domain - INFO - Class distribution:
1    369
0    226
Name: is_malicious, dtype: int64
2025-12-23 00:33:50,069 - train_domain - INFO - Malicious percentage: 62.02%
2025-12-23 00:33:50,069 - train_domain - INFO - Starting feature engineering...
2025-12-23 00:33:50,104 - train_domain - INFO - Feature engineering completed. Total features: 23
2025-12-23 00:33:50,105 - train_domain - INFO - Feature columns: ['is_malicious', 'domain_length', 'num_dots', 'num_hyphens', 'num_underscores', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'consonant_count', 'tld_length', 'subdomain_count', 'name_length', 'special_char_count', 'entropy', 'is_ip_like', 'has_common_tld', 'has_suspicious_tld', 'has_mixed_case', 'vowel_ratio', 'digit_ratio', 'has_common_word', 'is_random_like']
2025-12-23 00:33:50,124 - train_domain - INFO - X shape: (595, 22), y shape: (595,)
2025-12-23 00:33:50,124 - train_domain - INFO - Feature names: ['domain_length', 'num_dots', 'num_hyphens', 'num_underscores', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'consonant_count', 'tld_length', 'subdomain_count', 'name_length', 'special_char_count', 'entropy', 'is_ip_like', 'has_common_tld', 'has_suspicious_tld', 'has_mixed_case', 'vowel_ratio', 'digit_ratio', 'has_common_word', 'is_random_like']
2025-12-23 00:33:50,125 - train_domain - INFO - Scaling features...
2025-12-23 00:33:50,128 - train_domain - INFO - Train set: 476 samples
2025-12-23 00:33:50,128 - train_domain - INFO - Test set: 119 samples
2025-12-23 00:33:50,129 - train_domain - INFO - Positive samples in train: 295 (62.0%)
2025-12-23 00:33:50,129 - train_domain - INFO - Positive samples in test: 74 (62.2%)
2025-12-23 00:33:50,129 - train_domain - INFO - 
============================================================
2025-12-23 00:33:50,129 - train_domain - INFO - STARTING MODEL TRAINING
2025-12-23 00:33:50,129 - train_domain - INFO - ============================================================
2025-12-23 00:33:50,129 - train_domain - INFO - 
Training logistic_regression...
2025-12-23 00:33:52,896 - train_domain - INFO - logistic_regression Results:
2025-12-23 00:33:52,896 - train_domain - INFO -   Best Parameters: {'C': 1, 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-12-23 00:33:52,896 - train_domain - INFO -   Training Accuracy: 0.993697
2025-12-23 00:33:52,897 - train_domain - INFO -   Testing Accuracy: 0.991597
2025-12-23 00:33:52,897 - train_domain - INFO -   Precision: 0.986667
2025-12-23 00:33:52,897 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:33:52,897 - train_domain - INFO -   F1-Score: 0.993289
2025-12-23 00:33:52,897 - train_domain - INFO -   *** New Best Model! ***
2025-12-23 00:33:52,897 - train_domain - INFO - 
Training random_forest...
2025-12-23 00:34:02,359 - train_domain - INFO - random_forest Results:
2025-12-23 00:34:02,359 - train_domain - INFO -   Best Parameters: {'max_depth': 10, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 50}
2025-12-23 00:34:02,360 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:34:02,360 - train_domain - INFO -   Testing Accuracy: 0.991597
2025-12-23 00:34:02,360 - train_domain - INFO -   Precision: 0.986667
2025-12-23 00:34:02,361 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:34:02,361 - train_domain - INFO -   F1-Score: 0.993289
2025-12-23 00:34:02,361 - train_domain - INFO - 
Training gradient_boosting...
2025-12-23 00:34:14,279 - train_domain - INFO - gradient_boosting Results:
2025-12-23 00:34:14,280 - train_domain - INFO -   Best Parameters: {'learning_rate': 0.1, 'max_depth': 3, 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 50, 'subsample': 0.9}
2025-12-23 00:34:14,280 - train_domain - INFO -   Training Accuracy: 1.000000
2025-12-23 00:34:14,280 - train_domain - INFO -   Testing Accuracy: 0.991597
2025-12-23 00:34:14,280 - train_domain - INFO -   Precision: 0.986667
2025-12-23 00:34:14,280 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:34:14,280 - train_domain - INFO -   F1-Score: 0.993289
2025-12-23 00:34:14,280 - train_domain - INFO - 
Training svc...
2025-12-23 00:34:14,398 - train_domain - INFO - svc Results:
2025-12-23 00:34:14,398 - train_domain - INFO -   Best Parameters: {'C': 1, 'gamma': 'scale', 'kernel': 'linear', 'max_iter': 1000}
2025-12-23 00:34:14,398 - train_domain - INFO -   Training Accuracy: 0.995798
2025-12-23 00:34:14,398 - train_domain - INFO -   Testing Accuracy: 0.991597
2025-12-23 00:34:14,399 - train_domain - INFO -   Precision: 0.986667
2025-12-23 00:34:14,399 - train_domain - INFO -   Recall: 1.000000
2025-12-23 00:34:14,399 - train_domain - INFO -   F1-Score: 0.993289
2025-12-23 00:34:14,399 - train_domain - INFO - 
============================================================
2025-12-23 00:34:14,399 - train_domain - INFO - TRAINING SUMMARY
2025-12-23 00:34:14,399 - train_domain - INFO - ============================================================
2025-12-23 00:34:14,399 - train_domain - INFO - LOGISTIC_REGRESSION  Test Acc: 0.9916 | Precision: 0.9867 | Recall: 1.0000 | F1: 0.9933
2025-12-23 00:34:14,400 - train_domain - INFO - RANDOM_FOREST        Test Acc: 0.9916 | Precision: 0.9867 | Recall: 1.0000 | F1: 0.9933
2025-12-23 00:34:14,400 - train_domain - INFO - GRADIENT_BOOSTING    Test Acc: 0.9916 | Precision: 0.9867 | Recall: 1.0000 | F1: 0.9933
2025-12-23 00:34:14,400 - train_domain - INFO - SVC                  Test Acc: 0.9916 | Precision: 0.9867 | Recall: 1.0000 | F1: 0.9933
2025-12-23 00:34:14,400 - train_domain - INFO - 
Best model: logistic_regression
2025-12-23 00:34:14,400 - train_domain - INFO - Best accuracy: 0.9916
2025-12-23 00:34:14,400 - train_domain - INFO - Best parameters: {'C': 1, 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-12-23 00:34:14,400 - train_domain - INFO - 
============================================================
2025-12-23 00:34:14,400 - train_domain - INFO - FINAL EVALUATION OF BEST MODEL
2025-12-23 00:34:14,400 - train_domain - INFO - ============================================================
2025-12-23 00:34:14,405 - train_domain - INFO - Accuracy: 0.9916
2025-12-23 00:34:14,405 - train_domain - INFO - Precision: 0.9917
2025-12-23 00:34:14,405 - train_domain - INFO - Recall: 0.9916
2025-12-23 00:34:14,405 - train_domain - INFO - F1-Score: 0.9916
2025-12-23 00:34:14,406 - train_domain - INFO - Confusion Matrix:
[[44  1]
 [ 0 74]]
2025-12-23 00:34:14,407 - train_domain - INFO - 
Confusion Matrix:
2025-12-23 00:34:14,407 - train_domain - INFO -   True Negatives:  44
2025-12-23 00:34:14,407 - train_domain - INFO -   False Positives: 1
2025-12-23 00:34:14,407 - train_domain - INFO -   False Negatives: 0
2025-12-23 00:34:14,407 - train_domain - INFO -   True Positives:  74
2025-12-23 00:34:14,407 - train_domain - INFO -   False Positive Rate: 0.0222
2025-12-23 00:34:14,407 - train_domain - INFO -   False Negative Rate: 0.0000
2025-12-23 00:34:14,831 - train_domain - INFO - 
Model saved to: models/domain_model.pkl
2025-12-23 00:34:14,831 - train_domain - INFO - Scaler saved to: models/scaler_domain.pkl
2025-12-23 00:34:14,882 - train_domain - INFO - Feature names saved to: models/domain_feature_names.pkl
2025-12-23 00:34:14,887 - train_domain - INFO - 
============================================================
2025-12-23 00:34:14,887 - train_domain - INFO - TRAINING COMPLETED SUCCESSFULLY
2025-12-23 00:34:14,888 - train_domain - INFO - Total training time: 24.86 seconds
2025-12-23 00:34:14,888 - train_domain - INFO - ============================================================
2025-12-23 00:39:20,272 - train_domain - INFO - Training started
2025-12-23 00:39:20,272 - train_domain - INFO - ============================================================
2025-12-23 00:39:20,273 - train_domain - INFO - STARTING DOMAIN MODEL TRAINING
2025-12-23 00:39:20,273 - train_domain - INFO - ============================================================
2025-12-23 00:39:20,277 - train_domain - INFO - Removed 106 duplicate domains.
2025-12-23 00:39:20,277 - train_domain - INFO - Domain dataset loaded successfully. Shape: (595, 4)
2025-12-23 00:39:20,278 - train_domain - INFO - Class distribution:
1    369
0    226
Name: is_malicious, dtype: int64
2025-12-23 00:39:20,317 - train_domain - INFO - Benign domains: 226 (38.0%)
2025-12-23 00:39:20,317 - train_domain - INFO - Malicious domains: 369 (62.0%)
2025-12-23 00:39:20,317 - train_domain - INFO - Adding more benign domains to balance dataset...
2025-12-23 00:39:20,327 - train_domain - INFO - Added 117 new benign domains
2025-12-23 00:39:20,327 - train_domain - INFO - New dataset shape: (712, 4)
2025-12-23 00:39:20,327 - train_domain - INFO - Starting feature engineering...
2025-12-23 00:39:20,328 - train_domain - INFO - Removed 0 invalid/short domains
2025-12-23 00:39:20,368 - train_domain - INFO - Feature engineering completed. Total features: 20
2025-12-23 00:39:20,368 - train_domain - INFO - Feature columns: ['is_malicious', 'domain_length', 'num_dots', 'num_hyphens', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'has_common_tld', 'has_suspicious_tld', 'tld_length', 'name_length', 'is_ip_like', 'has_suspicious_word', 'entropy', 'vowel_ratio', 'digit_ratio', 'subdomain_count', 'has_mixed_case', 'has_consecutive_special']
2025-12-23 00:39:20,371 - train_domain - INFO - Final dataset shape - X: (712, 19), y: (712,)
2025-12-23 00:39:20,371 - train_domain - INFO - Class distribution: {1: 369, 0: 343}
2025-12-23 00:39:20,372 - train_domain - INFO - Scaling features...
2025-12-23 00:39:20,376 - train_domain - INFO - 
Data Split Summary:
2025-12-23 00:39:20,376 - train_domain - INFO - Train set: 569 samples
2025-12-23 00:39:20,376 - train_domain - INFO - Test set: 143 samples
2025-12-23 00:39:20,376 - train_domain - INFO - Positive samples in train: 295 (51.8%)
2025-12-23 00:39:20,376 - train_domain - INFO - Positive samples in test: 74 (51.7%)
2025-12-23 00:39:20,377 - train_domain - INFO - Class weights: {0: 1.0383211678832116, 1: 0.964406779661017}
2025-12-23 00:39:20,377 - train_domain - INFO - 
============================================================
2025-12-23 00:39:20,377 - train_domain - INFO - STARTING MODEL TRAINING
2025-12-23 00:39:20,378 - train_domain - INFO - ============================================================
2025-12-23 00:39:20,378 - train_domain - INFO - 
Training logistic_regression...
2025-12-23 00:39:20,414 - train_domain - INFO -   Cross-validation scores (5-fold): [1.         0.99122807 1.         0.99122807 0.99115044]
2025-12-23 00:39:20,414 - train_domain - INFO -   Mean CV accuracy: 0.9947 (+/- 0.0086)
2025-12-23 00:39:23,033 - train_domain - INFO - logistic_regression Results:
2025-12-23 00:39:23,033 - train_domain - INFO -   Best Parameters: {'C': 1, 'max_iter': 1000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-12-23 00:39:23,033 - train_domain - INFO -   Training Accuracy: 0.9947
2025-12-23 00:39:23,034 - train_domain - INFO -   Testing Accuracy: 0.9930
2025-12-23 00:39:23,034 - train_domain - INFO -   Precision: 0.9867
2025-12-23 00:39:23,034 - train_domain - INFO -   Recall: 1.0000
2025-12-23 00:39:23,034 - train_domain - INFO -   F1-Score: 0.9933
2025-12-23 00:39:23,034 - train_domain - INFO -   *** New Best Model! ***
2025-12-23 00:39:23,034 - train_domain - INFO - 
Training random_forest...
2025-12-23 00:39:23,681 - train_domain - INFO -   Cross-validation scores (5-fold): [1.         0.99122807 0.99122807 0.99122807 0.99115044]
2025-12-23 00:39:23,681 - train_domain - INFO -   Mean CV accuracy: 0.9930 (+/- 0.0070)
2025-12-23 00:39:31,589 - train_domain - INFO - random_forest Results:
2025-12-23 00:39:31,589 - train_domain - INFO -   Best Parameters: {'max_depth': 10, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 100}
2025-12-23 00:39:31,589 - train_domain - INFO -   Training Accuracy: 0.9982
2025-12-23 00:39:31,589 - train_domain - INFO -   Testing Accuracy: 1.0000
2025-12-23 00:39:31,590 - train_domain - INFO -   Precision: 1.0000
2025-12-23 00:39:31,590 - train_domain - INFO -   Recall: 1.0000
2025-12-23 00:39:31,590 - train_domain - INFO -   F1-Score: 1.0000
2025-12-23 00:39:31,590 - train_domain - INFO -   *** New Best Model! ***
2025-12-23 00:39:31,590 - train_domain - INFO - 
Training gradient_boosting...
2025-12-23 00:39:32,105 - train_domain - INFO -   Cross-validation scores (5-fold): [1.         0.99122807 1.         0.97368421 0.99115044]
2025-12-23 00:39:32,105 - train_domain - INFO -   Mean CV accuracy: 0.9912 (+/- 0.0192)
2025-12-23 00:39:44,006 - train_domain - INFO - gradient_boosting Results:
2025-12-23 00:39:44,006 - train_domain - INFO -   Best Parameters: {'learning_rate': 0.05, 'max_depth': 5, 'min_samples_leaf': 1, 'min_samples_split': 5, 'n_estimators': 150, 'subsample': 0.8}
2025-12-23 00:39:44,007 - train_domain - INFO -   Training Accuracy: 0.9982
2025-12-23 00:39:44,007 - train_domain - INFO -   Testing Accuracy: 0.9930
2025-12-23 00:39:44,007 - train_domain - INFO -   Precision: 0.9867
2025-12-23 00:39:44,008 - train_domain - INFO -   Recall: 1.0000
2025-12-23 00:39:44,008 - train_domain - INFO -   F1-Score: 0.9933
2025-12-23 00:39:44,008 - train_domain - INFO - 
Training svc...
2025-12-23 00:39:44,048 - train_domain - INFO -   Cross-validation scores (5-fold): [1.         1.         0.99122807 0.99122807 0.99115044]
2025-12-23 00:39:44,048 - train_domain - INFO -   Mean CV accuracy: 0.9947 (+/- 0.0086)
2025-12-23 00:39:44,180 - train_domain - INFO - svc Results:
2025-12-23 00:39:44,180 - train_domain - INFO -   Best Parameters: {'C': 10, 'gamma': 'scale', 'kernel': 'linear', 'max_iter': 2000, 'tol': 0.001}
2025-12-23 00:39:44,180 - train_domain - INFO -   Training Accuracy: 0.9982
2025-12-23 00:39:44,181 - train_domain - INFO -   Testing Accuracy: 1.0000
2025-12-23 00:39:44,181 - train_domain - INFO -   Precision: 1.0000
2025-12-23 00:39:44,181 - train_domain - INFO -   Recall: 1.0000
2025-12-23 00:39:44,181 - train_domain - INFO -   F1-Score: 1.0000
2025-12-23 00:39:44,182 - train_domain - INFO - 
============================================================
2025-12-23 00:39:44,182 - train_domain - INFO - TRAINING SUMMARY
2025-12-23 00:39:44,182 - train_domain - INFO - ============================================================
2025-12-23 00:39:44,182 - train_domain - INFO - LOGISTIC_REGRESSION       Test Acc: 0.9930 | Precision: 0.9867 | Recall: 1.0000 | F1: 0.9933 | CV Mean: 0.9947
2025-12-23 00:39:44,182 - train_domain - INFO - RANDOM_FOREST             Test Acc: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000 | CV Mean: 0.9930
2025-12-23 00:39:44,183 - train_domain - INFO - GRADIENT_BOOSTING         Test Acc: 0.9930 | Precision: 0.9867 | Recall: 1.0000 | F1: 0.9933 | CV Mean: 0.9912
2025-12-23 00:39:44,183 - train_domain - INFO - SVC                       Test Acc: 1.0000 | Precision: 1.0000 | Recall: 1.0000 | F1: 1.0000 | CV Mean: 0.9947
2025-12-23 00:39:44,183 - train_domain - INFO - 
Best model: random_forest
2025-12-23 00:39:44,183 - train_domain - INFO - Best accuracy: 1.0000
2025-12-23 00:39:44,183 - train_domain - INFO - Best parameters: {'max_depth': 10, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 100}
2025-12-23 00:39:44,183 - train_domain - INFO - 
============================================================
2025-12-23 00:39:44,183 - train_domain - INFO - FINAL EVALUATION OF BEST MODEL
2025-12-23 00:39:44,184 - train_domain - INFO - ============================================================
2025-12-23 00:39:44,193 - train_domain - INFO - 
Classification Report:
              precision    recall  f1-score   support

      Benign       1.00      1.00      1.00        69
   Malicious       1.00      1.00      1.00        74

    accuracy                           1.00       143
   macro avg       1.00      1.00      1.00       143
weighted avg       1.00      1.00      1.00       143

2025-12-23 00:39:44,198 - train_domain - INFO - Accuracy: 1.0000
2025-12-23 00:39:44,199 - train_domain - INFO - Precision: 1.0000
2025-12-23 00:39:44,199 - train_domain - INFO - Recall: 1.0000
2025-12-23 00:39:44,199 - train_domain - INFO - F1-Score: 1.0000
2025-12-23 00:39:44,199 - train_domain - INFO - Confusion Matrix:
[[69  0]
 [ 0 74]]
2025-12-23 00:39:44,222 - train_domain - INFO - 
Feature Importance (Top 10):
2025-12-23 00:39:44,222 - train_domain - INFO -    1. num_hyphens                   : 0.3000
2025-12-23 00:39:44,222 - train_domain - INFO -    2. domain_length                 : 0.2124
2025-12-23 00:39:44,222 - train_domain - INFO -    3. name_length                   : 0.1453
2025-12-23 00:39:44,223 - train_domain - INFO -    4. letter_count                  : 0.0899
2025-12-23 00:39:44,223 - train_domain - INFO -    5. has_suspicious_tld            : 0.0835
2025-12-23 00:39:44,223 - train_domain - INFO -    6. has_common_tld                : 0.0594
2025-12-23 00:39:44,223 - train_domain - INFO -    7. vowel_count                   : 0.0426
2025-12-23 00:39:44,223 - train_domain - INFO -    8. entropy                       : 0.0410
2025-12-23 00:39:44,224 - train_domain - INFO -    9. has_suspicious_word           : 0.0100
2025-12-23 00:39:44,224 - train_domain - INFO -   10. tld_length                    : 0.0088
2025-12-23 00:39:44,225 - train_domain - INFO - 
Confusion Matrix:
2025-12-23 00:39:44,225 - train_domain - INFO -   True Negatives (Benign correctly classified):  69
2025-12-23 00:39:44,225 - train_domain - INFO -   False Positives (Benign classified as Malicious): 0
2025-12-23 00:39:44,225 - train_domain - INFO -   False Negatives (Malicious classified as Benign): 0
2025-12-23 00:39:44,225 - train_domain - INFO -   True Positives (Malicious correctly classified):  74
2025-12-23 00:39:44,225 - train_domain - INFO -   False Positive Rate: 0.0000
2025-12-23 00:39:44,225 - train_domain - INFO -   False Negative Rate: 0.0000
2025-12-23 00:39:44,716 - train_domain - INFO - 
Model saved to: models/domain_model.pkl
2025-12-23 00:39:44,717 - train_domain - INFO - Scaler saved to: models/scaler_domain.pkl
2025-12-23 00:39:44,897 - train_domain - INFO - Feature names saved to: models/domain_feature_names.pkl
2025-12-23 00:39:44,903 - train_domain - INFO - 
============================================================
2025-12-23 00:39:44,904 - train_domain - INFO - TRAINING COMPLETED SUCCESSFULLY
2025-12-23 00:39:44,904 - train_domain - INFO - Total training time: 24.63 seconds
2025-12-23 00:39:44,904 - train_domain - INFO - ============================================================
2025-12-23 00:52:27,218 - train_domain - INFO - Training started
2025-12-23 00:52:27,218 - train_domain - INFO - ============================================================
2025-12-23 00:52:27,218 - train_domain - INFO - STARTING DOMAIN MODEL TRAINING WITH ROBUST VALIDATION
2025-12-23 00:52:27,219 - train_domain - INFO - ============================================================
2025-12-23 00:52:27,295 - train_domain - INFO - Removed 106 duplicate domains.
2025-12-23 00:52:27,295 - train_domain - INFO - Domain dataset loaded successfully. Shape: (645, 4)
2025-12-23 00:52:27,296 - train_domain - INFO - Class distribution:
1    399
0    246
Name: is_malicious, dtype: int64
2025-12-23 00:52:27,296 - train_domain - INFO - Benign domains: 246 (38.1%)
2025-12-23 00:52:27,298 - train_domain - INFO - Malicious domains: 399 (61.9%)
2025-12-23 00:52:27,298 - train_domain - INFO - Adding realistic domains to balance dataset...
2025-12-23 00:52:27,299 - train_domain - INFO - Added 50 new domains (mix of benign and malicious)
2025-12-23 00:52:27,300 - train_domain - INFO - New dataset shape: (695, 4)
2025-12-23 00:52:27,300 - train_domain - INFO - Updated class distribution: Benign=266, Malicious=429
2025-12-23 00:52:27,300 - train_domain - INFO - Starting feature engineering...
2025-12-23 00:52:27,300 - train_domain - INFO - Removed 0 invalid/short domains
2025-12-23 00:52:27,302 - train_domain - INFO - Removed 'risk_score' column to prevent data leakage
2025-12-23 00:52:27,302 - train_domain - INFO - Removed 'source' column to prevent data leakage
2025-12-23 00:52:27,376 - train_domain - INFO - Feature engineering completed. Total features: 29
2025-12-23 00:52:27,376 - train_domain - INFO - Feature columns: ['is_malicious', 'domain_length', 'num_dots', 'num_hyphens', 'num_underscores', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'consonant_count', 'has_common_tld', 'has_new_tld', 'tld_length', 'tld_is_numeric', 'name_length', 'starts_with_digit', 'has_4plus_consonants', 'has_suspicious_pattern', 'entropy', 'vowel_ratio', 'digit_ratio', 'letter_ratio', 'subdomain_count', 'has_subdomain', 'unique_char_ratio', 'has_repetitive_chars', 'has_mixed_case', 'has_consecutive_special', 'is_short_with_new_tld']
2025-12-23 00:52:27,386 - train_domain - INFO - Final dataset shape - X: (695, 28), y: (695,)
2025-12-23 00:52:27,387 - train_domain - INFO - Class distribution: {1: 429, 0: 266}
2025-12-23 00:52:27,387 - train_domain - INFO - Features: ['domain_length', 'num_dots', 'num_hyphens', 'num_underscores', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'consonant_count', 'has_common_tld', 'has_new_tld', 'tld_length', 'tld_is_numeric', 'name_length', 'starts_with_digit', 'has_4plus_consonants', 'has_suspicious_pattern', 'entropy', 'vowel_ratio', 'digit_ratio', 'letter_ratio', 'subdomain_count', 'has_subdomain', 'unique_char_ratio', 'has_repetitive_chars', 'has_mixed_case', 'has_consecutive_special', 'is_short_with_new_tld']
2025-12-23 00:52:27,387 - train_domain - INFO - Performing feature selection...
2025-12-23 00:52:27,495 - train_domain - INFO - Selected 15 features: ['domain_length', 'num_hyphens', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'consonant_count', 'has_common_tld', 'has_new_tld', 'name_length', 'has_suspicious_pattern', 'entropy', 'vowel_ratio', 'letter_ratio', 'unique_char_ratio']
2025-12-23 00:52:27,495 - train_domain - INFO - Scaling features...
2025-12-23 00:52:27,565 - train_domain - INFO - 
Data Split Summary:
2025-12-23 00:52:27,565 - train_domain - INFO - Train set (final): 444 samples
2025-12-23 00:52:27,565 - train_domain - INFO - Validation set: 112 samples
2025-12-23 00:52:27,565 - train_domain - INFO - Test set: 139 samples
2025-12-23 00:52:27,566 - train_domain - INFO - Total samples: 695
2025-12-23 00:52:27,585 - train_domain - INFO - Class weights: {0: 1.3058823529411765, 1: 0.8102189781021898}
2025-12-23 00:52:27,585 - train_domain - INFO - 
============================================================
2025-12-23 00:52:27,585 - train_domain - INFO - STARTING MODEL TRAINING WITH 10-FOLD CROSS VALIDATION
2025-12-23 00:52:27,586 - train_domain - INFO - ============================================================
2025-12-23 00:52:27,586 - train_domain - INFO - 
Training logistic_regression...
2025-12-23 00:52:29,949 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.94545455 0.98181818 0.98181818 0.93103448 0.92857143 0.88
 0.96296296 0.94117647 0.94545455 0.96296296]
2025-12-23 00:52:29,950 - train_domain - INFO -   Mean CV F1: 0.9461 (+/- 0.0567)
2025-12-23 00:52:31,247 - train_domain - INFO - logistic_regression Results:
2025-12-23 00:52:31,247 - train_domain - INFO -   Best Parameters: {'C': 0.1, 'max_iter': 2000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-12-23 00:52:31,248 - train_domain - INFO -   Training Accuracy: 0.9559
2025-12-23 00:52:31,248 - train_domain - INFO -   Validation Accuracy: 0.9732 (F1: 0.9781)
2025-12-23 00:52:31,248 - train_domain - INFO -   Testing Accuracy: 0.9424
2025-12-23 00:52:31,248 - train_domain - INFO -   Precision: 0.9643
2025-12-23 00:52:31,249 - train_domain - INFO -   Recall: 0.9419
2025-12-23 00:52:31,249 - train_domain - INFO -   F1-Score: 0.9529
2025-12-23 00:52:31,249 - train_domain - INFO -   *** New Best Model! (Validation F1: 0.9781) ***
2025-12-23 00:52:31,249 - train_domain - INFO - 
Training random_forest...
2025-12-23 00:52:31,815 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.98181818 0.98181818 0.98181818 0.94736842 0.96296296 0.92592593
 0.98181818 0.98113208 0.98181818 0.98113208]
2025-12-23 00:52:31,816 - train_domain - INFO -   Mean CV F1: 0.9708 (+/- 0.0371)
2025-12-23 00:53:40,923 - train_domain - INFO - random_forest Results:
2025-12-23 00:53:40,924 - train_domain - INFO -   Best Parameters: {'bootstrap': True, 'max_depth': 5, 'max_features': 0.5, 'min_samples_leaf': 1, 'min_samples_split': 5, 'n_estimators': 50}
2025-12-23 00:53:40,924 - train_domain - INFO -   Training Accuracy: 0.9890
2025-12-23 00:53:40,924 - train_domain - INFO -   Validation Accuracy: 1.0000 (F1: 1.0000)
2025-12-23 00:53:40,925 - train_domain - INFO -   Testing Accuracy: 0.9712
2025-12-23 00:53:40,925 - train_domain - INFO -   Precision: 0.9881
2025-12-23 00:53:40,925 - train_domain - INFO -   Recall: 0.9651
2025-12-23 00:53:40,926 - train_domain - INFO -   F1-Score: 0.9765
2025-12-23 00:53:40,926 - train_domain - INFO -   *** New Best Model! (Validation F1: 1.0000) ***
2025-12-23 00:53:40,927 - train_domain - INFO - 
Training gradient_boosting...
2025-12-23 00:53:41,227 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.98181818 0.96428571 0.98181818 0.94736842 0.94545455 0.94339623
 0.98181818 0.96153846 0.98181818 0.98113208]
2025-12-23 00:53:41,227 - train_domain - INFO -   Mean CV F1: 0.9670 (+/- 0.0318)
2025-12-23 00:57:37,160 - train_domain - INFO - gradient_boosting Results:
2025-12-23 00:57:37,162 - train_domain - INFO -   Best Parameters: {'learning_rate': 0.05, 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 1, 'min_samples_split': 10, 'n_estimators': 50, 'subsample': 0.8}
2025-12-23 00:57:37,162 - train_domain - INFO -   Training Accuracy: 0.9909
2025-12-23 00:57:37,162 - train_domain - INFO -   Validation Accuracy: 0.9911 (F1: 0.9928)
2025-12-23 00:57:37,162 - train_domain - INFO -   Testing Accuracy: 0.9640
2025-12-23 00:57:37,163 - train_domain - INFO -   Precision: 0.9655
2025-12-23 00:57:37,163 - train_domain - INFO -   Recall: 0.9767
2025-12-23 00:57:37,163 - train_domain - INFO -   F1-Score: 0.9711
2025-12-23 00:57:37,163 - train_domain - INFO - 
Training svc...
2025-12-23 00:57:37,514 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.98181818 0.96428571 1.         0.98181818 0.92857143 0.94339623
 0.96296296 0.98113208 0.98181818 0.98113208]
2025-12-23 00:57:37,515 - train_domain - INFO -   Mean CV F1: 0.9707 (+/- 0.0403)
2025-12-23 00:57:40,193 - train_domain - INFO - svc Results:
2025-12-23 00:57:40,194 - train_domain - INFO -   Best Parameters: {'C': 1, 'degree': 3, 'gamma': 0.1, 'kernel': 'poly', 'max_iter': 5000, 'tol': 0.0001}
2025-12-23 00:57:40,194 - train_domain - INFO -   Training Accuracy: 0.9836
2025-12-23 00:57:40,194 - train_domain - INFO -   Validation Accuracy: 0.9821 (F1: 0.9857)
2025-12-23 00:57:40,194 - train_domain - INFO -   Testing Accuracy: 0.9784
2025-12-23 00:57:40,194 - train_domain - INFO -   Precision: 0.9882
2025-12-23 00:57:40,195 - train_domain - INFO -   Recall: 0.9767
2025-12-23 00:57:40,195 - train_domain - INFO -   F1-Score: 0.9825
2025-12-23 00:57:40,195 - train_domain - INFO - 
============================================================
2025-12-23 00:57:40,195 - train_domain - INFO - MODEL PERFORMANCE SUMMARY
2025-12-23 00:57:40,195 - train_domain - INFO - ============================================================
2025-12-23 00:57:40,196 - train_domain - INFO - LOGISTIC_REGRESSION       Val F1: 0.9781 | Test Acc: 0.9424 | Precision: 0.9643 | Recall: 0.9419 | F1: 0.9529
2025-12-23 00:57:40,196 - train_domain - INFO - RANDOM_FOREST             Val F1: 1.0000 | Test Acc: 0.9712 | Precision: 0.9881 | Recall: 0.9651 | F1: 0.9765
2025-12-23 00:57:40,196 - train_domain - INFO - GRADIENT_BOOSTING         Val F1: 0.9928 | Test Acc: 0.9640 | Precision: 0.9655 | Recall: 0.9767 | F1: 0.9711
2025-12-23 00:57:40,196 - train_domain - INFO - SVC                       Val F1: 0.9857 | Test Acc: 0.9784 | Precision: 0.9882 | Recall: 0.9767 | F1: 0.9825
2025-12-23 00:57:40,196 - train_domain - INFO - 
Best model: random_forest
2025-12-23 00:57:40,196 - train_domain - INFO - Best validation F1: 1.0000
2025-12-23 00:57:40,196 - train_domain - INFO - Best parameters: {'bootstrap': True, 'max_depth': 5, 'max_features': 0.5, 'min_samples_leaf': 1, 'min_samples_split': 5, 'n_estimators': 50}
2025-12-23 00:57:40,196 - train_domain - INFO - 
============================================================
2025-12-23 00:57:40,196 - train_domain - INFO - FINAL COMPREHENSIVE EVALUATION
2025-12-23 00:57:40,196 - train_domain - INFO - ============================================================
2025-12-23 00:57:40,207 - train_domain - INFO - 
Classification Report:
              precision    recall  f1-score   support

      Benign       0.95      0.98      0.96        53
   Malicious       0.99      0.97      0.98        86

    accuracy                           0.97       139
   macro avg       0.97      0.97      0.97       139
weighted avg       0.97      0.97      0.97       139

2025-12-23 00:57:40,207 - train_domain - INFO - 
============================================================
2025-12-23 00:57:40,207 - train_domain - INFO - COMPREHENSIVE MODEL VALIDATION
2025-12-23 00:57:40,208 - train_domain - INFO - ============================================================
2025-12-23 00:57:40,212 - train_domain - INFO - Accuracy: 0.9712
2025-12-23 00:57:40,212 - train_domain - INFO - Precision: 0.9881
2025-12-23 00:57:40,212 - train_domain - INFO - Recall: 0.9651
2025-12-23 00:57:40,212 - train_domain - INFO - F1-Score: 0.9765
2025-12-23 00:57:40,306 - train_domain - INFO - ROC-AUC Score: 0.9954
2025-12-23 00:57:40,312 - train_domain - INFO - 
Confusion Matrix Details:
2025-12-23 00:57:40,312 - train_domain - INFO - True Negatives:  52
2025-12-23 00:57:40,312 - train_domain - INFO - False Positives: 1
2025-12-23 00:57:40,313 - train_domain - INFO - False Negatives: 3
2025-12-23 00:57:40,313 - train_domain - INFO - True Positives:  83
2025-12-23 00:57:40,313 - train_domain - INFO - False Positive Rate: 0.0189
2025-12-23 00:57:40,313 - train_domain - INFO - False Negative Rate: 0.0349
2025-12-23 00:57:40,318 - train_domain - INFO - 
Feature Importance (Top 10):
2025-12-23 00:57:40,318 - train_domain - INFO -    1. num_hyphens                   : 0.2789
2025-12-23 00:57:40,318 - train_domain - INFO -    2. name_length                   : 0.2378
2025-12-23 00:57:40,319 - train_domain - INFO -    3. domain_length                 : 0.2109
2025-12-23 00:57:40,319 - train_domain - INFO -    4. letter_count                  : 0.0820
2025-12-23 00:57:40,319 - train_domain - INFO -    5. letter_ratio                  : 0.0670
2025-12-23 00:57:40,319 - train_domain - INFO -    6. digit_count                   : 0.0307
2025-12-23 00:57:40,319 - train_domain - INFO -    7. entropy                       : 0.0302
2025-12-23 00:57:40,319 - train_domain - INFO -    8. has_digits                    : 0.0242
2025-12-23 00:57:40,320 - train_domain - INFO -    9. consonant_count               : 0.0120
2025-12-23 00:57:40,320 - train_domain - INFO -   10. vowel_ratio                   : 0.0082
2025-12-23 00:57:41,585 - train_domain - INFO - 
Model saved to: models/domain_model.pkl
2025-12-23 00:57:41,585 - train_domain - INFO - Scaler saved to: models/scaler_domain.pkl
2025-12-23 00:57:41,585 - train_domain - INFO - Feature selector saved to: models/selector_domain.pkl
2025-12-23 00:57:41,585 - train_domain - INFO - Selected feature names saved to: models/domain_feature_names.pkl
2025-12-23 00:57:41,590 - train_domain - INFO - 
============================================================
2025-12-23 00:57:41,590 - train_domain - INFO - TRAINING COMPLETED WITH REALISTIC VALIDATION
2025-12-23 00:57:41,591 - train_domain - INFO - Total training time: 314.37 seconds
2025-12-23 00:57:41,591 - train_domain - INFO - ============================================================
2025-12-23 00:57:41,591 - train_domain - INFO - 
============================================================
2025-12-23 00:57:41,591 - train_domain - INFO - RECOMMENDATIONS FOR PRODUCTION USE
2025-12-23 00:57:41,592 - train_domain - INFO - ============================================================
2025-12-23 00:57:41,592 - train_domain - INFO - 1. Monitor false positive rate in production
2025-12-23 00:57:41,592 - train_domain - INFO - 2. Regularly update training data with new domain patterns
2025-12-23 00:57:41,592 - train_domain - INFO - 3. Consider ensemble methods for better generalization
2025-12-23 00:57:41,592 - train_domain - INFO - 4. Implement a confidence threshold for predictions
2025-12-23 00:57:41,592 - train_domain - INFO - 5. Track model drift over time
2025-12-23 22:22:10,092 - train_domain - INFO - Training started
2025-12-23 22:22:10,092 - train_domain - INFO - ============================================================
2025-12-23 22:22:10,092 - train_domain - INFO - STARTING DOMAIN MODEL TRAINING WITH ROBUST VALIDATION
2025-12-23 22:22:10,092 - train_domain - INFO - ============================================================
2025-12-23 22:22:10,154 - train_domain - INFO - Removed 106 duplicate domains.
2025-12-23 22:22:10,154 - train_domain - INFO - Domain dataset loaded successfully. Shape: (645, 4)
2025-12-23 22:22:10,155 - train_domain - INFO - Class distribution:
1    399
0    246
Name: is_malicious, dtype: int64
2025-12-23 22:22:10,156 - train_domain - INFO - Benign domains: 246 (38.1%)
2025-12-23 22:22:10,156 - train_domain - INFO - Malicious domains: 399 (61.9%)
2025-12-23 22:22:10,156 - train_domain - INFO - Adding realistic domains to balance dataset...
2025-12-23 22:22:10,157 - train_domain - INFO - Added 50 new domains (mix of benign and malicious)
2025-12-23 22:22:10,157 - train_domain - INFO - New dataset shape: (695, 4)
2025-12-23 22:22:10,158 - train_domain - INFO - Updated class distribution: Benign=266, Malicious=429
2025-12-23 22:22:10,158 - train_domain - INFO - Starting feature engineering...
2025-12-23 22:22:10,158 - train_domain - INFO - Removed 0 invalid/short domains
2025-12-23 22:22:10,160 - train_domain - INFO - Removed 'risk_score' column to prevent data leakage
2025-12-23 22:22:10,160 - train_domain - INFO - Removed 'source' column to prevent data leakage
2025-12-23 22:22:10,232 - train_domain - INFO - Feature engineering completed. Total features: 29
2025-12-23 22:22:10,232 - train_domain - INFO - Feature columns: ['is_malicious', 'domain_length', 'num_dots', 'num_hyphens', 'num_underscores', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'consonant_count', 'has_common_tld', 'has_new_tld', 'tld_length', 'tld_is_numeric', 'name_length', 'starts_with_digit', 'has_4plus_consonants', 'has_suspicious_pattern', 'entropy', 'vowel_ratio', 'digit_ratio', 'letter_ratio', 'subdomain_count', 'has_subdomain', 'unique_char_ratio', 'has_repetitive_chars', 'has_mixed_case', 'has_consecutive_special', 'is_short_with_new_tld']
2025-12-23 22:22:10,235 - train_domain - INFO - Final dataset shape - X: (695, 28), y: (695,)
2025-12-23 22:22:10,236 - train_domain - INFO - Class distribution: {1: 429, 0: 266}
2025-12-23 22:22:10,236 - train_domain - INFO - Features: ['domain_length', 'num_dots', 'num_hyphens', 'num_underscores', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'consonant_count', 'has_common_tld', 'has_new_tld', 'tld_length', 'tld_is_numeric', 'name_length', 'starts_with_digit', 'has_4plus_consonants', 'has_suspicious_pattern', 'entropy', 'vowel_ratio', 'digit_ratio', 'letter_ratio', 'subdomain_count', 'has_subdomain', 'unique_char_ratio', 'has_repetitive_chars', 'has_mixed_case', 'has_consecutive_special', 'is_short_with_new_tld']
2025-12-23 22:22:10,237 - train_domain - INFO - Performing feature selection...
2025-12-23 22:22:10,314 - train_domain - INFO - Selected 15 features: ['domain_length', 'num_hyphens', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'consonant_count', 'has_common_tld', 'has_new_tld', 'name_length', 'has_suspicious_pattern', 'entropy', 'vowel_ratio', 'letter_ratio', 'unique_char_ratio']
2025-12-23 22:22:10,314 - train_domain - INFO - Scaling features...
2025-12-23 22:22:10,383 - train_domain - INFO - 
Data Split Summary:
2025-12-23 22:22:10,383 - train_domain - INFO - Train set (final): 444 samples
2025-12-23 22:22:10,383 - train_domain - INFO - Validation set: 112 samples
2025-12-23 22:22:10,383 - train_domain - INFO - Test set: 139 samples
2025-12-23 22:22:10,383 - train_domain - INFO - Total samples: 695
2025-12-23 22:22:10,417 - train_domain - INFO - Class weights: {0: 1.3058823529411765, 1: 0.8102189781021898}
2025-12-23 22:22:10,418 - train_domain - INFO - 
============================================================
2025-12-23 22:22:10,418 - train_domain - INFO - STARTING MODEL TRAINING WITH 10-FOLD CROSS VALIDATION
2025-12-23 22:22:10,418 - train_domain - INFO - ============================================================
2025-12-23 22:22:10,418 - train_domain - INFO - 
Training logistic_regression...
2025-12-23 22:22:13,857 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.94545455 0.98181818 0.98181818 0.93103448 0.92857143 0.88
 0.96296296 0.94117647 0.94545455 0.96296296]
2025-12-23 22:22:13,859 - train_domain - INFO -   Mean CV F1: 0.9461 (+/- 0.0567)
2025-12-23 22:22:15,030 - train_domain - INFO - logistic_regression Results:
2025-12-23 22:22:15,031 - train_domain - INFO -   Best Parameters: {'C': 0.1, 'max_iter': 2000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-12-23 22:22:15,031 - train_domain - INFO -   Training Accuracy: 0.9559
2025-12-23 22:22:15,031 - train_domain - INFO -   Validation Accuracy: 0.9732 (F1: 0.9781)
2025-12-23 22:22:15,031 - train_domain - INFO -   Testing Accuracy: 0.9424
2025-12-23 22:22:15,032 - train_domain - INFO -   Precision: 0.9643
2025-12-23 22:22:15,032 - train_domain - INFO -   Recall: 0.9419
2025-12-23 22:22:15,032 - train_domain - INFO -   F1-Score: 0.9529
2025-12-23 22:22:15,032 - train_domain - INFO -   *** New Best Model! (Validation F1: 0.9781) ***
2025-12-23 22:22:15,032 - train_domain - INFO - 
Training random_forest...
2025-12-23 22:22:15,630 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.98181818 0.98181818 0.98181818 0.94736842 0.96296296 0.92592593
 0.98181818 0.98113208 0.98181818 0.98113208]
2025-12-23 22:22:15,633 - train_domain - INFO -   Mean CV F1: 0.9708 (+/- 0.0371)
2025-12-23 22:23:13,978 - train_domain - INFO - random_forest Results:
2025-12-23 22:23:13,979 - train_domain - INFO -   Best Parameters: {'bootstrap': True, 'max_depth': 5, 'max_features': 0.5, 'min_samples_leaf': 1, 'min_samples_split': 5, 'n_estimators': 50}
2025-12-23 22:23:13,979 - train_domain - INFO -   Training Accuracy: 0.9890
2025-12-23 22:23:13,979 - train_domain - INFO -   Validation Accuracy: 1.0000 (F1: 1.0000)
2025-12-23 22:23:13,979 - train_domain - INFO -   Testing Accuracy: 0.9712
2025-12-23 22:23:13,979 - train_domain - INFO -   Precision: 0.9881
2025-12-23 22:23:13,980 - train_domain - INFO -   Recall: 0.9651
2025-12-23 22:23:13,980 - train_domain - INFO -   F1-Score: 0.9765
2025-12-23 22:23:13,980 - train_domain - INFO -   *** New Best Model! (Validation F1: 1.0000) ***
2025-12-23 22:23:13,980 - train_domain - INFO - 
Training gradient_boosting...
2025-12-23 22:23:14,262 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.98181818 0.96428571 0.98181818 0.94736842 0.94545455 0.94339623
 0.98181818 0.96153846 0.98181818 0.98113208]
2025-12-23 22:23:14,263 - train_domain - INFO -   Mean CV F1: 0.9670 (+/- 0.0318)
2025-12-23 22:26:51,896 - train_domain - INFO - gradient_boosting Results:
2025-12-23 22:26:51,897 - train_domain - INFO -   Best Parameters: {'learning_rate': 0.05, 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 1, 'min_samples_split': 10, 'n_estimators': 50, 'subsample': 0.8}
2025-12-23 22:26:51,897 - train_domain - INFO -   Training Accuracy: 0.9909
2025-12-23 22:26:51,897 - train_domain - INFO -   Validation Accuracy: 0.9911 (F1: 0.9928)
2025-12-23 22:26:51,897 - train_domain - INFO -   Testing Accuracy: 0.9640
2025-12-23 22:26:51,897 - train_domain - INFO -   Precision: 0.9655
2025-12-23 22:26:51,897 - train_domain - INFO -   Recall: 0.9767
2025-12-23 22:26:51,898 - train_domain - INFO -   F1-Score: 0.9711
2025-12-23 22:26:51,898 - train_domain - INFO - 
Training svc...
2025-12-23 22:26:52,269 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.98181818 0.96428571 1.         0.98181818 0.92857143 0.94339623
 0.96296296 0.98113208 0.98181818 0.98113208]
2025-12-23 22:26:52,271 - train_domain - INFO -   Mean CV F1: 0.9707 (+/- 0.0403)
2025-12-23 22:26:53,627 - train_domain - INFO - svc Results:
2025-12-23 22:26:53,628 - train_domain - INFO -   Best Parameters: {'C': 1, 'gamma': 'scale', 'kernel': 'rbf', 'max_iter': 10000, 'tol': 0.0001}
2025-12-23 22:26:53,628 - train_domain - INFO -   Training Accuracy: 0.9797
2025-12-23 22:26:53,628 - train_domain - INFO -   Validation Accuracy: 0.9911 (F1: 0.9927)
2025-12-23 22:26:53,628 - train_domain - INFO -   Testing Accuracy: 0.9640
2025-12-23 22:26:53,629 - train_domain - INFO -   Precision: 0.9880
2025-12-23 22:26:53,629 - train_domain - INFO -   Recall: 0.9535
2025-12-23 22:26:53,629 - train_domain - INFO -   F1-Score: 0.9704
2025-12-23 22:26:53,629 - train_domain - INFO - 
============================================================
2025-12-23 22:26:53,629 - train_domain - INFO - MODEL PERFORMANCE SUMMARY
2025-12-23 22:26:53,629 - train_domain - INFO - ============================================================
2025-12-23 22:26:53,630 - train_domain - INFO - LOGISTIC_REGRESSION       Val F1: 0.9781 | Test Acc: 0.9424 | Precision: 0.9643 | Recall: 0.9419 | F1: 0.9529
2025-12-23 22:26:53,630 - train_domain - INFO - RANDOM_FOREST             Val F1: 1.0000 | Test Acc: 0.9712 | Precision: 0.9881 | Recall: 0.9651 | F1: 0.9765
2025-12-23 22:26:53,630 - train_domain - INFO - GRADIENT_BOOSTING         Val F1: 0.9928 | Test Acc: 0.9640 | Precision: 0.9655 | Recall: 0.9767 | F1: 0.9711
2025-12-23 22:26:53,630 - train_domain - INFO - SVC                       Val F1: 0.9927 | Test Acc: 0.9640 | Precision: 0.9880 | Recall: 0.9535 | F1: 0.9704
2025-12-23 22:26:53,630 - train_domain - INFO - 
Best model: random_forest
2025-12-23 22:26:53,630 - train_domain - INFO - Best validation F1: 1.0000
2025-12-23 22:26:53,630 - train_domain - INFO - Best parameters: {'bootstrap': True, 'max_depth': 5, 'max_features': 0.5, 'min_samples_leaf': 1, 'min_samples_split': 5, 'n_estimators': 50}
2025-12-23 22:26:53,631 - train_domain - INFO - 
============================================================
2025-12-23 22:26:53,631 - train_domain - INFO - FINAL COMPREHENSIVE EVALUATION
2025-12-23 22:26:53,631 - train_domain - INFO - ============================================================
2025-12-23 22:26:53,641 - train_domain - INFO - 
Classification Report:
              precision    recall  f1-score   support

      Benign       0.95      0.98      0.96        53
   Malicious       0.99      0.97      0.98        86

    accuracy                           0.97       139
   macro avg       0.97      0.97      0.97       139
weighted avg       0.97      0.97      0.97       139

2025-12-23 22:26:53,641 - train_domain - INFO - 
============================================================
2025-12-23 22:26:53,641 - train_domain - INFO - COMPREHENSIVE MODEL VALIDATION
2025-12-23 22:26:53,641 - train_domain - INFO - ============================================================
2025-12-23 22:26:53,647 - train_domain - INFO - Accuracy: 0.9712
2025-12-23 22:26:53,647 - train_domain - INFO - Precision: 0.9881
2025-12-23 22:26:53,647 - train_domain - INFO - Recall: 0.9651
2025-12-23 22:26:53,647 - train_domain - INFO - F1-Score: 0.9765
2025-12-23 22:26:53,696 - train_domain - INFO - ROC-AUC Score: 0.9954
2025-12-23 22:26:53,710 - train_domain - INFO - 
Confusion Matrix Details:
2025-12-23 22:26:53,710 - train_domain - INFO - True Negatives:  52
2025-12-23 22:26:53,712 - train_domain - INFO - False Positives: 1
2025-12-23 22:26:53,712 - train_domain - INFO - False Negatives: 3
2025-12-23 22:26:53,712 - train_domain - INFO - True Positives:  83
2025-12-23 22:26:53,712 - train_domain - INFO - False Positive Rate: 0.0189
2025-12-23 22:26:53,712 - train_domain - INFO - False Negative Rate: 0.0349
2025-12-23 22:26:53,717 - train_domain - INFO - 
Feature Importance (Top 10):
2025-12-23 22:26:53,717 - train_domain - INFO -    1. num_hyphens                   : 0.2789
2025-12-23 22:26:53,717 - train_domain - INFO -    2. name_length                   : 0.2378
2025-12-23 22:26:53,718 - train_domain - INFO -    3. domain_length                 : 0.2109
2025-12-23 22:26:53,718 - train_domain - INFO -    4. letter_count                  : 0.0820
2025-12-23 22:26:53,718 - train_domain - INFO -    5. letter_ratio                  : 0.0670
2025-12-23 22:26:53,718 - train_domain - INFO -    6. digit_count                   : 0.0307
2025-12-23 22:26:53,718 - train_domain - INFO -    7. entropy                       : 0.0302
2025-12-23 22:26:53,719 - train_domain - INFO -    8. has_digits                    : 0.0242
2025-12-23 22:26:53,719 - train_domain - INFO -    9. consonant_count               : 0.0120
2025-12-23 22:26:53,719 - train_domain - INFO -   10. vowel_ratio                   : 0.0082
2025-12-23 22:26:58,954 - train_domain - INFO - 
Model saved to: models/domain_model.pkl
2025-12-23 22:26:58,955 - train_domain - INFO - Scaler saved to: models/scaler_domain.pkl
2025-12-23 22:26:58,955 - train_domain - INFO - Feature selector saved to: models/selector_domain.pkl
2025-12-23 22:26:58,955 - train_domain - INFO - Selected feature names saved to: models/domain_feature_names.pkl
2025-12-23 22:26:58,958 - train_domain - INFO - 
============================================================
2025-12-23 22:26:58,958 - train_domain - INFO - TRAINING COMPLETED WITH REALISTIC VALIDATION
2025-12-23 22:26:58,959 - train_domain - INFO - Total training time: 288.87 seconds
2025-12-23 22:26:58,959 - train_domain - INFO - ============================================================
2025-12-23 22:26:58,959 - train_domain - INFO - 
============================================================
2025-12-23 22:26:58,959 - train_domain - INFO - RECOMMENDATIONS FOR PRODUCTION USE
2025-12-23 22:26:58,959 - train_domain - INFO - ============================================================
2025-12-23 22:26:58,959 - train_domain - INFO - 1. Monitor false positive rate in production
2025-12-23 22:26:58,959 - train_domain - INFO - 2. Regularly update training data with new domain patterns
2025-12-23 22:26:58,959 - train_domain - INFO - 3. Consider ensemble methods for better generalization
2025-12-23 22:26:58,959 - train_domain - INFO - 4. Implement a confidence threshold for predictions
2025-12-23 22:26:58,960 - train_domain - INFO - 5. Track model drift over time
2025-12-23 22:29:16,401 - train_domain - INFO - Training started
2025-12-23 22:29:16,401 - train_domain - INFO - ============================================================
2025-12-23 22:29:16,401 - train_domain - INFO - STARTING DOMAIN MODEL TRAINING WITH ROBUST VALIDATION
2025-12-23 22:29:16,401 - train_domain - INFO - ============================================================
2025-12-23 22:29:16,405 - train_domain - INFO - Removed 106 duplicate domains.
2025-12-23 22:29:16,405 - train_domain - INFO - Domain dataset loaded successfully. Shape: (645, 4)
2025-12-23 22:29:16,406 - train_domain - INFO - Class distribution:
1    399
0    246
Name: is_malicious, dtype: int64
2025-12-23 22:29:16,406 - train_domain - INFO - Benign domains: 246 (38.1%)
2025-12-23 22:29:16,406 - train_domain - INFO - Malicious domains: 399 (61.9%)
2025-12-23 22:29:16,406 - train_domain - INFO - Adding realistic domains to balance dataset...
2025-12-23 22:29:16,407 - train_domain - INFO - Added 50 new domains (mix of benign and malicious)
2025-12-23 22:29:16,407 - train_domain - INFO - New dataset shape: (695, 4)
2025-12-23 22:29:16,408 - train_domain - INFO - Updated class distribution: Benign=266, Malicious=429
2025-12-23 22:29:16,408 - train_domain - INFO - Starting feature engineering...
2025-12-23 22:29:16,409 - train_domain - INFO - Removed 0 invalid/short domains
2025-12-23 22:29:16,409 - train_domain - INFO - Removed 'risk_score' column to prevent data leakage
2025-12-23 22:29:16,409 - train_domain - INFO - Removed 'source' column to prevent data leakage
2025-12-23 22:29:16,457 - train_domain - INFO - Feature engineering completed. Total features: 29
2025-12-23 22:29:16,457 - train_domain - INFO - Feature columns: ['is_malicious', 'domain_length', 'num_dots', 'num_hyphens', 'num_underscores', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'consonant_count', 'has_common_tld', 'has_new_tld', 'tld_length', 'tld_is_numeric', 'name_length', 'starts_with_digit', 'has_4plus_consonants', 'has_suspicious_pattern', 'entropy', 'vowel_ratio', 'digit_ratio', 'letter_ratio', 'subdomain_count', 'has_subdomain', 'unique_char_ratio', 'has_repetitive_chars', 'has_mixed_case', 'has_consecutive_special', 'is_short_with_new_tld']
2025-12-23 22:29:16,459 - train_domain - INFO - Final dataset shape - X: (695, 28), y: (695,)
2025-12-23 22:29:16,459 - train_domain - INFO - Class distribution: {1: 429, 0: 266}
2025-12-23 22:29:16,459 - train_domain - INFO - Features: ['domain_length', 'num_dots', 'num_hyphens', 'num_underscores', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'consonant_count', 'has_common_tld', 'has_new_tld', 'tld_length', 'tld_is_numeric', 'name_length', 'starts_with_digit', 'has_4plus_consonants', 'has_suspicious_pattern', 'entropy', 'vowel_ratio', 'digit_ratio', 'letter_ratio', 'subdomain_count', 'has_subdomain', 'unique_char_ratio', 'has_repetitive_chars', 'has_mixed_case', 'has_consecutive_special', 'is_short_with_new_tld']
2025-12-23 22:29:16,459 - train_domain - INFO - Performing feature selection...
2025-12-23 22:29:16,463 - train_domain - INFO - Selected 15 features: ['domain_length', 'num_hyphens', 'has_digits', 'digit_count', 'letter_count', 'vowel_count', 'consonant_count', 'has_common_tld', 'has_new_tld', 'name_length', 'has_suspicious_pattern', 'entropy', 'vowel_ratio', 'letter_ratio', 'unique_char_ratio']
2025-12-23 22:29:16,463 - train_domain - INFO - Scaling features...
2025-12-23 22:29:16,465 - train_domain - INFO - 
Data Split Summary:
2025-12-23 22:29:16,466 - train_domain - INFO - Train set (final): 444 samples
2025-12-23 22:29:16,466 - train_domain - INFO - Validation set: 112 samples
2025-12-23 22:29:16,466 - train_domain - INFO - Test set: 139 samples
2025-12-23 22:29:16,466 - train_domain - INFO - Total samples: 695
2025-12-23 22:29:16,467 - train_domain - INFO - Class weights: {0: 1.3058823529411765, 1: 0.8102189781021898}
2025-12-23 22:29:16,467 - train_domain - INFO - 
============================================================
2025-12-23 22:29:16,467 - train_domain - INFO - STARTING MODEL TRAINING WITH 10-FOLD CROSS VALIDATION
2025-12-23 22:29:16,467 - train_domain - INFO - ============================================================
2025-12-23 22:29:16,467 - train_domain - INFO - 
Training logistic_regression...
2025-12-23 22:29:18,277 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.94545455 0.98181818 0.98181818 0.93103448 0.92857143 0.88
 0.96296296 0.94117647 0.94545455 0.96296296]
2025-12-23 22:29:18,278 - train_domain - INFO -   Mean CV F1: 0.9461 (+/- 0.0567)
2025-12-23 22:29:19,356 - train_domain - INFO - logistic_regression Results:
2025-12-23 22:29:19,357 - train_domain - INFO -   Best Parameters: {'C': 0.1, 'max_iter': 2000, 'penalty': 'l2', 'solver': 'lbfgs'}
2025-12-23 22:29:19,357 - train_domain - INFO -   Training Accuracy: 0.9559
2025-12-23 22:29:19,357 - train_domain - INFO -   Validation Accuracy: 0.9732 (F1: 0.9781)
2025-12-23 22:29:19,357 - train_domain - INFO -   Testing Accuracy: 0.9424
2025-12-23 22:29:19,358 - train_domain - INFO -   Precision: 0.9643
2025-12-23 22:29:19,358 - train_domain - INFO -   Recall: 0.9419
2025-12-23 22:29:19,358 - train_domain - INFO -   F1-Score: 0.9529
2025-12-23 22:29:19,358 - train_domain - INFO -   *** New Best Model! (Validation F1: 0.9781) ***
2025-12-23 22:29:19,359 - train_domain - INFO - 
Training random_forest...
2025-12-23 22:29:19,709 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.98181818 0.98181818 0.98181818 0.94736842 0.96296296 0.92592593
 0.98181818 0.98113208 0.98181818 0.98113208]
2025-12-23 22:29:19,710 - train_domain - INFO -   Mean CV F1: 0.9708 (+/- 0.0371)
2025-12-23 22:30:18,232 - train_domain - INFO - random_forest Results:
2025-12-23 22:30:18,232 - train_domain - INFO -   Best Parameters: {'bootstrap': True, 'max_depth': 5, 'max_features': 0.5, 'min_samples_leaf': 1, 'min_samples_split': 5, 'n_estimators': 50}
2025-12-23 22:30:18,232 - train_domain - INFO -   Training Accuracy: 0.9890
2025-12-23 22:30:18,232 - train_domain - INFO -   Validation Accuracy: 1.0000 (F1: 1.0000)
2025-12-23 22:30:18,232 - train_domain - INFO -   Testing Accuracy: 0.9712
2025-12-23 22:30:18,232 - train_domain - INFO -   Precision: 0.9881
2025-12-23 22:30:18,232 - train_domain - INFO -   Recall: 0.9651
2025-12-23 22:30:18,232 - train_domain - INFO -   F1-Score: 0.9765
2025-12-23 22:30:18,233 - train_domain - INFO -   *** New Best Model! (Validation F1: 1.0000) ***
2025-12-23 22:30:18,233 - train_domain - INFO - 
Training gradient_boosting...
2025-12-23 22:30:18,516 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.98181818 0.96428571 0.98181818 0.94736842 0.94545455 0.94339623
 0.98181818 0.96153846 0.98181818 0.98113208]
2025-12-23 22:30:18,516 - train_domain - INFO -   Mean CV F1: 0.9670 (+/- 0.0318)
2025-12-23 22:33:54,613 - train_domain - INFO - gradient_boosting Results:
2025-12-23 22:33:54,614 - train_domain - INFO -   Best Parameters: {'learning_rate': 0.05, 'max_depth': 4, 'max_features': None, 'min_samples_leaf': 1, 'min_samples_split': 10, 'n_estimators': 50, 'subsample': 0.8}
2025-12-23 22:33:54,614 - train_domain - INFO -   Training Accuracy: 0.9909
2025-12-23 22:33:54,615 - train_domain - INFO -   Validation Accuracy: 0.9911 (F1: 0.9928)
2025-12-23 22:33:54,615 - train_domain - INFO -   Testing Accuracy: 0.9640
2025-12-23 22:33:54,615 - train_domain - INFO -   Precision: 0.9655
2025-12-23 22:33:54,615 - train_domain - INFO -   Recall: 0.9767
2025-12-23 22:33:54,615 - train_domain - INFO -   F1-Score: 0.9711
2025-12-23 22:33:54,615 - train_domain - INFO - 
Training svc...
2025-12-23 22:33:54,646 - train_domain - INFO -   Cross-validation F1 scores (10-fold): [0.98181818 0.96428571 1.         0.98181818 0.92857143 0.94339623
 0.96296296 0.98113208 0.98181818 0.98113208]
2025-12-23 22:33:54,648 - train_domain - INFO -   Mean CV F1: 0.9707 (+/- 0.0403)
2025-12-23 22:33:56,706 - train_domain - INFO - svc Results:
2025-12-23 22:33:56,706 - train_domain - INFO -   Best Parameters: {'C': 1, 'gamma': 'scale', 'kernel': 'rbf', 'max_iter': 100000, 'tol': 0.0001}
2025-12-23 22:33:56,706 - train_domain - INFO -   Training Accuracy: 0.9797
2025-12-23 22:33:56,706 - train_domain - INFO -   Validation Accuracy: 0.9911 (F1: 0.9927)
2025-12-23 22:33:56,707 - train_domain - INFO -   Testing Accuracy: 0.9640
2025-12-23 22:33:56,707 - train_domain - INFO -   Precision: 0.9880
2025-12-23 22:33:56,707 - train_domain - INFO -   Recall: 0.9535
2025-12-23 22:33:56,707 - train_domain - INFO -   F1-Score: 0.9704
2025-12-23 22:33:56,707 - train_domain - INFO - 
============================================================
2025-12-23 22:33:56,707 - train_domain - INFO - MODEL PERFORMANCE SUMMARY
2025-12-23 22:33:56,707 - train_domain - INFO - ============================================================
2025-12-23 22:33:56,707 - train_domain - INFO - LOGISTIC_REGRESSION       Val F1: 0.9781 | Test Acc: 0.9424 | Precision: 0.9643 | Recall: 0.9419 | F1: 0.9529
2025-12-23 22:33:56,708 - train_domain - INFO - RANDOM_FOREST             Val F1: 1.0000 | Test Acc: 0.9712 | Precision: 0.9881 | Recall: 0.9651 | F1: 0.9765
2025-12-23 22:33:56,708 - train_domain - INFO - GRADIENT_BOOSTING         Val F1: 0.9928 | Test Acc: 0.9640 | Precision: 0.9655 | Recall: 0.9767 | F1: 0.9711
2025-12-23 22:33:56,708 - train_domain - INFO - SVC                       Val F1: 0.9927 | Test Acc: 0.9640 | Precision: 0.9880 | Recall: 0.9535 | F1: 0.9704
2025-12-23 22:33:56,708 - train_domain - INFO - 
Best model: random_forest
2025-12-23 22:33:56,708 - train_domain - INFO - Best validation F1: 1.0000
2025-12-23 22:33:56,708 - train_domain - INFO - Best parameters: {'bootstrap': True, 'max_depth': 5, 'max_features': 0.5, 'min_samples_leaf': 1, 'min_samples_split': 5, 'n_estimators': 50}
2025-12-23 22:33:56,708 - train_domain - INFO - 
============================================================
2025-12-23 22:33:56,708 - train_domain - INFO - FINAL COMPREHENSIVE EVALUATION
2025-12-23 22:33:56,708 - train_domain - INFO - ============================================================
2025-12-23 22:33:56,718 - train_domain - INFO - 
Classification Report:
              precision    recall  f1-score   support

      Benign       0.95      0.98      0.96        53
   Malicious       0.99      0.97      0.98        86

    accuracy                           0.97       139
   macro avg       0.97      0.97      0.97       139
weighted avg       0.97      0.97      0.97       139

2025-12-23 22:33:56,718 - train_domain - INFO - 
============================================================
2025-12-23 22:33:56,719 - train_domain - INFO - COMPREHENSIVE MODEL VALIDATION
2025-12-23 22:33:56,719 - train_domain - INFO - ============================================================
2025-12-23 22:33:56,724 - train_domain - INFO - Accuracy: 0.9712
2025-12-23 22:33:56,724 - train_domain - INFO - Precision: 0.9881
2025-12-23 22:33:56,725 - train_domain - INFO - Recall: 0.9651
2025-12-23 22:33:56,725 - train_domain - INFO - F1-Score: 0.9765
2025-12-23 22:33:56,727 - train_domain - INFO - ROC-AUC Score: 0.9954
2025-12-23 22:33:56,728 - train_domain - INFO - 
Confusion Matrix Details:
2025-12-23 22:33:56,728 - train_domain - INFO - True Negatives:  52
2025-12-23 22:33:56,728 - train_domain - INFO - False Positives: 1
2025-12-23 22:33:56,729 - train_domain - INFO - False Negatives: 3
2025-12-23 22:33:56,729 - train_domain - INFO - True Positives:  83
2025-12-23 22:33:56,729 - train_domain - INFO - False Positive Rate: 0.0189
2025-12-23 22:33:56,729 - train_domain - INFO - False Negative Rate: 0.0349
2025-12-23 22:33:56,734 - train_domain - INFO - 
Feature Importance (Top 10):
2025-12-23 22:33:56,734 - train_domain - INFO -    1. num_hyphens                   : 0.2789
2025-12-23 22:33:56,734 - train_domain - INFO -    2. name_length                   : 0.2378
2025-12-23 22:33:56,734 - train_domain - INFO -    3. domain_length                 : 0.2109
2025-12-23 22:33:56,735 - train_domain - INFO -    4. letter_count                  : 0.0820
2025-12-23 22:33:56,735 - train_domain - INFO -    5. letter_ratio                  : 0.0670
2025-12-23 22:33:56,735 - train_domain - INFO -    6. digit_count                   : 0.0307
2025-12-23 22:33:56,735 - train_domain - INFO -    7. entropy                       : 0.0302
2025-12-23 22:33:56,735 - train_domain - INFO -    8. has_digits                    : 0.0242
2025-12-23 22:33:56,736 - train_domain - INFO -    9. consonant_count               : 0.0120
2025-12-23 22:33:56,736 - train_domain - INFO -   10. vowel_ratio                   : 0.0082
2025-12-23 22:33:57,413 - train_domain - INFO - 
Model saved to: models/domain_model.pkl
2025-12-23 22:33:57,413 - train_domain - INFO - Scaler saved to: models/scaler_domain.pkl
2025-12-23 22:33:57,414 - train_domain - INFO - Feature selector saved to: models/selector_domain.pkl
2025-12-23 22:33:57,414 - train_domain - INFO - Selected feature names saved to: models/domain_feature_names.pkl
2025-12-23 22:33:57,418 - train_domain - INFO - 
============================================================
2025-12-23 22:33:57,418 - train_domain - INFO - TRAINING COMPLETED WITH REALISTIC VALIDATION
2025-12-23 22:33:57,418 - train_domain - INFO - Total training time: 281.02 seconds
2025-12-23 22:33:57,418 - train_domain - INFO - ============================================================
2025-12-23 22:33:57,418 - train_domain - INFO - 
============================================================
2025-12-23 22:33:57,418 - train_domain - INFO - RECOMMENDATIONS FOR PRODUCTION USE
2025-12-23 22:33:57,418 - train_domain - INFO - ============================================================
2025-12-23 22:33:57,419 - train_domain - INFO - 1. Monitor false positive rate in production
2025-12-23 22:33:57,419 - train_domain - INFO - 2. Regularly update training data with new domain patterns
2025-12-23 22:33:57,419 - train_domain - INFO - 3. Consider ensemble methods for better generalization
2025-12-23 22:33:57,419 - train_domain - INFO - 4. Implement a confidence threshold for predictions
2025-12-23 22:33:57,420 - train_domain - INFO - 5. Track model drift over time
